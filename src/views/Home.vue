<template>

<div>

   <div class="section bg-gray-100 px-0 lg:px-1">

     <div class=" ">
        <Navbar
        v-bind:web3Plug="web3Plug"

       />
     </div>


   </div>



   <div class="section  border-b-2 border-blue-800">
     <div class=" ">
       <div class=" ">

       </div>
       <div class="    w-full text-center ">

           <img src="@/assets/images/space_ship_3.png" class="" style="margin:0 auto; width:100%;  " />

       </div>
     </div>
   </div>

    <div class="section mt-16">
        <div class="container px-4 pb-10 mx-auto text-blue-900">
                <div class="flex">
                        <div class="flex-1">
                                <h1 class="text-4xl font-bold text-blue-700">Welcome to Cosmic Caps</h1>

                                <p>Cosmic Caps are a Non-Fungible species of 10,000 unique fungi making their way from the shroomiverse to the metaverse!</p>
                                <br>
                                <p>10,000 computer generated psychedelic mushrooms with 120 traits across 6 categories (cap, stem, eyes, mouth, background, and body props).</p>
                                <p>Cosmic Caps are stored as ERC721 tokens on the Ethereum blockchain. </p>
                                <br>
                                <p>Not only are Cosmic Caps psychedelic mushroom themed character-collectibles, they also serve as your ticket to a community of 3D content and serve to distinguish yourself in the metaverse.</p>
                        </div>
                        <div class="flex-1">
                                <img
                                src="@/assets/images/three_cosmic_caps_2.png"
                                alt="gold shroom, pink makeup"
                                class="shrooms9"/>
                        </div>
                </div>
                <br />

        </div>


        <div class="container px-4 pb-20 mx-auto">
                <h2 class="text-3xl font-bold text-blue-700">Price</h2>
                <br />
                <p>To Mint a Cosmic Cap, the cost is 0.06 Ether.</p>
                <br />
                <div class="button bg-yellow-400 text-2xl text-black font-bold my-2 py-3 px-6 rounded-xl shadow-md w-48 text-center">
                    Price 0.06 Ξ
                </div>
        </div>

    <div class="container px-4 pb-20 mx-auto">
        <div class="">
            <h2 class="text-3xl font-bold text-blue-700">Rarity</h2>

            <br>

            <p>Each Cosmic Cap is unqie! Some are more rare than others.</p>

            <p>Cosmic Caps are a Non-Fungible species of 10,000 unique fungi making their way from the shroomiverse to the metaverse!</p>

            <br>

            <p>Each Cosmic Cap is completely unique. Created using over 110 individual features.</p>

            <p>Cosmic Caps star in the upcoming Cosmic Cap animated series that is releasing this fall.</p>

            <br>

            <div class="flex mt-8">
                <div class="flex-1 max-w-sm rounded-3xl overflow-hidden shadow-md bg-gray-100 mx-3">
                  <img class="w-full" src="@/assets/images/cosmic_cap_1.png" alt="Sunset in the mountains">
                  <div class="px-6 py-5">
                    <h4 class="font-bold text-3xl mb-3">#3249</h4>
                    <p class="text-gray-700 text-base">
                      <img class="w-full" src="@/assets/images/trait-diagram.jpg" alt="Sunset in the mountains">
                    </p>
                  </div>
                </div>

                <div class="flex-1 max-w-sm rounded-3xl overflow-hidden shadow-md bg-gray-100 mx-3">
                  <img class="w-full" src="@/assets/images/cosmic_cap_4.png" alt="Sunset in the mountains">
                  <div class="px-6 py-5">
                    <h4 class="font-bold text-3xl mb-1">#3249</h4>
                    <p class="text-gray-700 text-base">
                      <img class="w-full" src="@/assets/images/trait-diagram.jpg" alt="Sunset in the mountains">
                    </p>
                  </div>
                </div>

                <div class="flex-1 max-w-sm rounded-3xl overflow-hidden shadow-md bg-gray-100 mx-3">
                  <img class="w-full" src="@/assets/images/cosmic_cap_2.png" alt="Sunset in the mountains">
                  <div class="px-6 py-5">
                    <h4 class="font-bold text-3xl mb-1">#3249</h4>
                    <p class="text-gray-700 text-base">
                      <img class="w-full" src="@/assets/images/trait-diagram.jpg" alt="Sunset in the mountains">
                    </p>
                  </div>
                </div>

                <div class="flex-1 max-w-sm rounded-3xl overflow-hidden shadow-md bg-gray-100 mx-3">
                  <img class="w-full" src="@/assets/images/cosmic_cap_3.png" alt="Sunset in the mountains">
                  <div class="px-6 py-5">
                    <h4 class="font-bold text-3xl mb-1">#3249</h4>
                    <p class="text-gray-700 text-base">
                      <img class="w-full" src="@/assets/images/trait-diagram.jpg" alt="Sunset in the mountains">
                    </p>
                  </div>
                </div>
            </div>

            <div class="flex mt-8">

                <div class="flex-1 max-w-sm rounded-3xl overflow-hidden shadow-md bg-gray-100 mx-3">
                  <img class="w-full" src="@/assets/images/cosmic_cap_11.png" alt="Sunset in the mountains">
                  <div class="px-6 py-5">
                    <h4 class="font-bold text-3xl mb-1">#3249</h4>
                    <p class="text-gray-700 text-base">
                      <img class="w-full" src="@/assets/images/trait-diagram.jpg" alt="Sunset in the mountains">
                    </p>
                  </div>
                </div>

                <div class="flex-1 max-w-sm rounded-3xl overflow-hidden shadow-md bg-gray-100 mx-3">
                  <img class="w-full" src="@/assets/images/cosmic_cap_5.png" alt="Sunset in the mountains">
                  <div class="px-6 py-5">
                    <h4 class="font-bold text-3xl mb-1">#3249</h4>
                    <p class="text-gray-700 text-base">
                      <img class="w-full" src="@/assets/images/trait-diagram.jpg" alt="Sunset in the mountains">
                    </p>
                  </div>
                </div>

                <div class="flex-1 max-w-sm rounded-3xl overflow-hidden shadow-md bg-gray-100 mx-3">
                  <img class="w-full" src="@/assets/images/cosmic_cap_9.png" alt="Sunset in the mountains">
                  <div class="px-6 py-5">
                    <h4 class="font-bold text-3xl mb-1">#3249</h4>
                    <p class="text-gray-700 text-base">
                      <img class="w-full" src="@/assets/images/trait-diagram.jpg" alt="Sunset in the mountains">
                    </p>
                  </div>
                </div>

                <div class="flex-1 max-w-sm rounded-3xl overflow-hidden shadow-md bg-gray-100 mx-3">
                  <img class="w-full" src="@/assets/images/cosmic_cap_12.png" alt="Sunset in the mountains">
                  <div class="px-6 py-5">
                    <h4 class="font-bold text-3xl mb-1">#3249</h4>
                    <p class="text-gray-700 text-base">
                      <img class="w-full" src="@/assets/images/trait-diagram.jpg" alt="Sunset in the mountains">
                    </p>
                  </div>
                </div>

            </div>
        </div>
    </div>
</div>

<div class="section bg-gray-300">
   <div class="container px-4 py-20 mx-auto">
           <div class="">
                   <h2 class="text-3xl font-bold text-blue-700 mb-6">FAQ</h2>

                   <h3 class="text-xl text-blue-700 mb-3">How do I adopt a Cosmic Cap?</h3>
                   <p class="mb-8">Once minting is live, you can connect your Metamask wallet and adopt up to 32 Cosmic Caps in one transaction. Make sure to have enough ETH to cover any extra gas costs and be careful not to be too slow, once they're gone they're gone and your transaction might fail!</p>
                   <br>
                   <h3 class="text-xl text-blue-700 mb-3" >How do I join the community?</h3>
                   <p class="mb-8">Cosmic Caps make great profile pictures so you can easily spot fellow community members! Follow the official Twitter account and come and say hi in the community Discord server.</p>
                   <br>
                   <h3 class="text-xl text-blue-700 mb-3" >Are Cosmic Caps supporting charities?</h3>
                   <p class="mb-8">We’re always looking at new ways to bring more value to our community. Once all of the Cosmic Caps have been minted, we plan to donate a percentage of the proceeds to the Multidisciplinary Association For Psychedelic Studies (MAPS). https://maps.org/about/
                   mission.
                   </p>
                   <h3 class="text-xl text-blue-700 mb-3" >What are NFTs?</h3>
                   <p class="mb-8">NFTs are Non-Fungible Tokens. Each Cosmic Cap NFT that you own is truly unique and verifiable on the Ethereum blockchain.
                   </p>
                   <br>
                   <h3 class="text-xl text-blue-700 mb-3" >What inpsired Cosmic Caps?</h3>
                   <p class="mb-8">Cosmic Caps was created by a team of DeFi builders who've been contributing to the Ethereum community since 2016. We've been avid NFT collectors and blown away by the uniting power of the NFT communities we've been involved with.
                   </p>
           </div>
   </div>
</div>


<div class="section">
    <div class="container px-4 py-20 mx-auto">
        <div class="">
                <h2 class="text-4xl font-bold text-blue-700 mb-6">Roadmap</h2>

                <br />

                <h3 class="text-2xl text-blue-900 font-bold mb-3">New Animated Short Series</h3>
                <p class="mb-8">Become one with the fungi and join us for the first release of Episode 1 of Cosmic Caps. After Epsiode 1, Cosmic Cap holders will have the ability to vote on the story line of Cosmic Caps. Earn unique 1/1 NFTs from the epsiode you watch and participate in.</p>

                <br />

                <h3 class="text-2xl text-blue-900 font-bold mb-3">ARKIT & Animations</h3>
                <p class="mb-8">Cosmic Caps owners will be able to stake their Cosmic Cap NFT to obtain a new animated 3D Cosmic Caps NFT (.GLB format) and ARKIT integration files. These can be imported into any metaverse or game engine that supports .GLB format.</p>

                <br />

                <h3 class="text-2xl text-blue-900 font-bold mb-3">Metaverse Integration</h3>
                <p class="mb-8">We’re always looking at new ways to bring more value to our community. Once all of the Cosmic Caps have been minted, we plan to donate a percentage of the proceeds to the Multidisciplinary Association For Psychedelic Studies (MAPS). https://maps.org/about/
                mission.
                </p>

                <br />

                <h3 class="text-2xl text-blue-900 font-bold mb-3">Web Store & Cosmic Cap Merchandise</h3>
                <p class="mb-8">NFTs are Non-Fungible Tokens. Each Cosmic Cap NFT that you own is truly unique and verifiable on the Ethereum blockchain.
                </p>

                <br />

                <h3 class="text-2xl text-blue-900 font-bold mb-3">Holders will be airdropped future Cosmic NFTs from each Episode</h3>
                <p class="mb-8">Cosmic Caps was created by a team of DeFi builders who've been contributing to the Ethereum community since 2016. We've been avid NFT collectors and blown away by the uniting power of the NFT communities we've been involved with.</p>

                <br />

                <h3 class="text-2xl text-blue-900 font-bold mb-3">Giving Back To Our Community</h3>
                <p class="mb-8">Cosmic Caps was created by a team of DeFi builders who've been contributing to the Ethereum community since 2016. We've been avid NFT collectors and blown away by the uniting power of the NFT communities we've been involved with.
                </p>

                <br />

                <h3 class="text-2xl text-blue-900 font-bold mb-3">Ownership rights</h3>
                <p class="mb-8">As long as you own the Cosmic Cap NFT, you’ll have exclusive rights to your Cosmic Cap.
                </p>
        </div>
    </div>
</div>


<div class="section bg-gray-300">
    <div class="container px-4 py-20 mx-auto flex">
            <div class="flex-1">
                    <img
                    src="@/assets/images/Logo.png"
                    alt="gold shroom, pink makeup"
                    class="logo"/>

            </div>
            <div class="flex-1">
                    <h2 class="text-3xl font-bold text-blue-700 mb-6">Donating to Science and Medicine!</h2>
                    <p>We’re always looking at new ways to bring more value to our community. Once all of the Cosmic Caps have been minted, we plan to donate a percentage of the proceeds to the Multidisciplinary Association For Psychedelic Studies (MAPS). https://maps.org/about/mission </p>
            </div>
    </div>
</div>



    <div class="section  text-white  border-b-2 border-black " v-if="signedInToWeb3" style="background:#222;">
     <div class="w-container  ">



          <div class=" w-2/3  mt-8 py-8" style="margin: 0 auto;">

                <div class="text-2xl text-center"> You will earn up to: {{  parseFloat( balances['WETH'] ) }} WETH </div>

                  <div class="flex flex-col my-8">
                    <label> Banana Token Id </label>
                     <input type="numeric" v-model="tokenId" class="text-black p-2 my-2" style="width:200px"/>
                  </div>

                 <div class="mt-8 bg-red-600 select-none hover:bg-red-500 cursor-pointer rounded p-4 text-white border-2 border-black inline-block" @click="smash()"> Smash my Banana! </div>
         </div>





     </div>
   </div>



<div class="section  border-b-2 border-black">
  <div class=" ">
    <div class=" ">

    </div>
    <div class="    w-full text-center ">

        <img src="@/assets/images/space_background_4k.jpg" class="" style="margin:0 auto; width:100%;  " />

    </div>
  </div>
</div>

     <div class="section  text-white  border-b-2 border-black " v-if="signedInToWeb3" style="background:#222;">
     <div class="w-container  ">



          <div class=" w-2/3  mt-8 py-8" style="margin: 0 auto;">

                <div class="text-2xl text-center"> Donate to teh Banana Smashers!! </div>

                <p class="text-sm text-center ">  (This will increase the amount of WETH that the next banana smasher will get -- duh!) </p>

                  <div class="flex flex-col my-8">
                    <label> WETH donation amount </label>
                     <input type="numeric" v-model="donationAmount" class="text-black p-2 my-2" style="width:200px"/>
                  </div>

                 <div class="mt-8 bg-yellow-500 select-none hover:bg-yellow-300 cursor-pointer rounded p-4 text-black border-2 border-black inline-block" @click="donate()"> Donate WETH! </div>
         </div>





     </div>
   </div>




  <Footer/>

</div>
</template>


<script>



import Web3Plug from '../js/web3-plug.js'


import Navbar from './components/Navbar.vue';

import Footer from './components/Footer.vue';
import TabsBar from './components/TabsBar.vue';

import FrontendHelper from '../js/frontend-helper.js';

const ERC721ABI = require('../contracts/ERC721ABI.json')


export default {
  name: 'Home',
  props: [],
  components: {Navbar, Footer },
  data() {
    return {
      web3Plug: new Web3Plug() ,
      signedInToWeb3: false,
      balances: {} ,
      tokenId: 0,
      donationAmount: 0

    }
  },

  created(){


    this.web3Plug.getPlugEventEmitter().on('stateChanged', function(connectionState) {
        console.log('stateChanged',connectionState);

        this.activeAccountAddress = connectionState.activeAccountAddress
        this.activeNetworkId = connectionState.activeNetworkId

        this.signedInToWeb3 =  (this.activeAccountAddress != null)

      }.bind(this));
   this.web3Plug.getPlugEventEmitter().on('error', function(errormessage) {
        console.error('error',errormessage);

        this.web3error = errormessage

      }.bind(this));

      this.web3Plug.reconnectWeb()



  },
  mounted: function () {
    this.getBalances()

    setInterval(  this.getBalances.bind(this), 5000  )
  },
  methods: {

          async getBalances(){

            const smasherAddress = '0xbf3122b2aa3102693e3194df7870e1a7ae146b50'

            const currencyAddress = '0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2' //WETH9

            const currencyContract = this.web3Plug.getTokenContract( currencyAddress )

            let wethBalanceRaw = await currencyContract.methods.balanceOf( smasherAddress ).call()

            this.balances['WETH'] = this.web3Plug.rawAmountToFormatted(wethBalanceRaw, 18)

            console.log(' this.balances',  this.balances)

            this.$forceUpdate()

          },


          smash( ){


              let tokenId = parseInt( this.tokenId )

                console.log('smash! ',tokenId)

              let userAddress = this.web3Plug.getActiveAccountAddress()

              const bananaContract = this.web3Plug.getCustomContract(  ERC721ABI , '0xb9ab19454ccb145f9643214616c5571b8a4ef4f2' )

              const currencyAddress = '0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2' //WETH9

              const smasherAddress = '0xbf3122b2aa3102693e3194df7870e1a7ae146b50'

              bananaContract.methods.safeTransferFrom( userAddress, smasherAddress, tokenId , currencyAddress ).send({from: userAddress })
          },


         donate( ){


              let donationAmount = this.web3Plug.formattedAmountToRaw( this.donationAmount, 18 )



              let userAddress = this.web3Plug.getActiveAccountAddress()


              const currencyAddress = '0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2' //WETH9

              const smasherAddress = '0xbf3122b2aa3102693e3194df7870e1a7ae146b50'

              const wethContract = this.web3Plug.getTokenContract(   currencyAddress  )


              wethContract.methods.transfer( smasherAddress, donationAmount ).send({from: userAddress })
          },


  }
}
</script>
